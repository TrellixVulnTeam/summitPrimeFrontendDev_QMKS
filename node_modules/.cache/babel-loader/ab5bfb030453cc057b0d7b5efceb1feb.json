{"ast":null,"code":"import { changePage, loading, savingOrcamento, toggleModal, updateOrcamentos } from \"./Actions\";\nimport callBackend from \"./CallBackend\";\nimport { ChangePage } from \"./ChangePage\";\n\nvar crypto = require(\"crypto\");\n\nexport const saveOrcamento = orcamento => {\n  console.log(orcamento);\n  return (dispatch, getState) => {\n    try {\n      dispatch(savingOrcamento(true));\n      let {\n        socket\n      } = getState().pages;\n      let {\n        salvos\n      } = getState().orcamentos;\n      let token = localStorage.getItem(\"token\");\n      let id;\n      console.log(orcamento);\n\n      if (Object.keys(orcamento)[[0]] === \"id\") {\n        orcamento = salvos.find(orc => {\n          return orc.id === orcamento.id;\n        });\n      } else if (Object.keys(orcamento)[[0]] === \"index\") {\n        orcamento = salvos[orcamento.index];\n      } else if (Object.keys(orcamento)[[0]] === \"titulo\") {\n        dispatch(loading(true));\n        id = crypto.randomBytes(20).toString(\"hex\").toUpperCase();\n        orcamento = {\n          id,\n          titulo: orcamento.titulo,\n          pagamentoAntecipado: false,\n          itens: [{\n            sku: \"\",\n            nome: \"\",\n            caixaMaster: 0,\n            valor: 0,\n            quantidade: 0,\n            multiplo: 0,\n            estoque: 0\n          }],\n          criadoEm: new Date(),\n          ultimaModificacao: new Date()\n        };\n      }\n\n      let {\n        subTotal,\n        subTotalDisponivel,\n        total,\n        totalDisponivel,\n        ...rest\n      } = orcamento;\n      orcamento = { ...rest,\n        ultimaModificacao: new Date()\n      };\n      callBackend(socket, \"saveOrcamento\", token, { ...orcamento\n      }).then(async r => {\n        dispatch(savingOrcamento(false));\n        dispatch(loading(false));\n\n        if (Object.keys(orcamento)[[0]] === \"titulo\") {\n          console.log(id);\n          await dispatch(updateOrcamentos({\n            salvos: r.orcamentos\n          }));\n          await dispatch(updateOrcamentos({\n            atual: id\n          }));\n          await dispatch(ChangePage(\"orcamentoAtual\"));\n          await dispatch(toggleModal(\"criarOrcamento\", false));\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n};","map":{"version":3,"sources":["C:/Users/rocan/OneDrive/Documents/SummitPrime/frontendDev/src/Redux/Actions/SaveOrcamento.js"],"names":["changePage","loading","savingOrcamento","toggleModal","updateOrcamentos","callBackend","ChangePage","crypto","require","saveOrcamento","orcamento","console","log","dispatch","getState","socket","pages","salvos","orcamentos","token","localStorage","getItem","id","Object","keys","find","orc","index","randomBytes","toString","toUpperCase","titulo","pagamentoAntecipado","itens","sku","nome","caixaMaster","valor","quantidade","multiplo","estoque","criadoEm","Date","ultimaModificacao","subTotal","subTotalDisponivel","total","totalDisponivel","rest","then","r","atual","e"],"mappings":"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","sourcesContent":["import {\r\n  changePage,\r\n  loading,\r\n  savingOrcamento,\r\n  toggleModal,\r\n  updateOrcamentos,\r\n} from \"./Actions\";\r\nimport callBackend from \"./CallBackend\";\r\nimport { ChangePage } from \"./ChangePage\";\r\nvar crypto = require(\"crypto\");\r\n\r\nexport const saveOrcamento = (orcamento) => {\r\n  console.log(orcamento);\r\n  return (dispatch, getState) => {\r\n    try {\r\n      dispatch(savingOrcamento(true));\r\n      let { socket } = getState().pages;\r\n      let { salvos } = getState().orcamentos;\r\n      let token = localStorage.getItem(\"token\");\r\n      let id;\r\n      console.log(orcamento);\r\n      if (Object.keys(orcamento)[[0]] === \"id\") {\r\n        orcamento = salvos.find((orc) => {\r\n          return orc.id === orcamento.id;\r\n        });\r\n      } else if (Object.keys(orcamento)[[0]] === \"index\") {\r\n        orcamento = salvos[orcamento.index];\r\n      } else if (Object.keys(orcamento)[[0]] === \"titulo\") {\r\n        dispatch(loading(true));\r\n        id = crypto.randomBytes(20).toString(\"hex\").toUpperCase();\r\n        orcamento = {\r\n          id,\r\n          titulo: orcamento.titulo,\r\n          pagamentoAntecipado: false,\r\n          itens: [\r\n            {\r\n              sku: \"\",\r\n              nome: \"\",\r\n              caixaMaster: 0,\r\n              valor: 0,\r\n              quantidade: 0,\r\n              multiplo: 0,\r\n              estoque: 0,\r\n            },\r\n          ],\r\n          criadoEm: new Date(),\r\n          ultimaModificacao: new Date(),\r\n        };\r\n      }\r\n      let { subTotal, subTotalDisponivel, total, totalDisponivel, ...rest } =\r\n        orcamento;\r\n      orcamento = { ...rest, ultimaModificacao: new Date() };\r\n      callBackend(socket, \"saveOrcamento\", token, { ...orcamento }).then(\r\n        async (r) => {\r\n          dispatch(savingOrcamento(false));\r\n          dispatch(loading(false));\r\n          if (Object.keys(orcamento)[[0]] === \"titulo\") {\r\n            console.log(id);\r\n            await dispatch(updateOrcamentos({ salvos: r.orcamentos }));\r\n            await dispatch(updateOrcamentos({ atual: id }));\r\n            await dispatch(ChangePage(\"orcamentoAtual\"));\r\n            await dispatch(toggleModal(\"criarOrcamento\", false));\r\n          }\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}